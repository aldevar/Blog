<!DOCTYPE html>

<html lang="en">
<head>
<!-- Required meta tags always come first -->
<meta charset="utf-8"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<title>Firefox comme navigateur par défaut de SailfishOS | Aldevar - Le Blog
</title>
<link href="/2015/08/firefox-comme-navigateur-par-defaut-de-sailfishos.html" rel="canonical"/>
<link href="/feed/atom.xml" rel="alternate" title="Full Atom Feed" type="application/atom+xml"/>
<link href="/theme/css/bootstrap.min.css" rel="stylesheet"/>
<link href="/theme/css/font-awesome.min.css" rel="stylesheet"/>
<link href="/theme/css/pygments/default.min.css" rel="stylesheet"/>
<link href="/theme/css/style.css" rel="stylesheet"/>
<meta content="Jolla et son SailfishOS sont vraiment de beaux outils mais il faut avouer qu'ils ont quand même un problème majeur, c'est la piètre qualité des navigateurs intégrés et surtout du navigateur par défaut. Malheureusement, l'interface ne propose actuellement aucune option pour modifier ce comportement. Ainsi, lorsqu'on clique sur un lien …" name="description"/>
</head>
<body>
<header class="header">
<div class="container">
<div class="row">
<div class="col-sm-4">
<a href="/">
<img alt="Aldevar - Le Blog" class="img-fluid" height="100" src="/images/avat180.png" width="100"/>
</a>
</div>
<div class="col-sm-8">
<h1 class="title"><a href="/">Aldevar - Le Blog</a></h1>
<p class="text-muted">Un blog IT</p>
<ul class="list-inline">
<li class="list-inline-item"><a href="/pages/about.html">About</a></li>
<li class=" list-inline-item text-muted">|</li>
<li class="list-inline-item"><a class="fa fa-twitter" href="https://twitter.com/landvarx" target="_blank"></a></li>
<li class="list-inline-item"><a class="fa fa-linkedin" href="https://www.linkedin.com/in/alain-devarieux" target="_blank"></a></li>
<li class="list-inline-item"><a class="fa fa-github" href="https://github.com/aldevar" target="_blank"></a></li>
<li class="list-inline-item"><a class="fa fa-meetup" href="https://www.meetup.com/fr-FR/Rennes-Monitoring/" target="_blank"></a></li>
</ul>
</div>
</div>
</div>
</header>
<div class="main">
<div class="container">
<h1>Firefox comme navigateur par défaut de SailfishOS
</h1>
<hr/>
<article class="article">
<header>
<ul class="list-inline">
<li class="list-inline-item text-muted" title="2015-08-24T09:17:00+02:00">
<i class="fa fa-clock-o"></i>
        lun. 24 août 2015
      </li>
<li class="list-inline-item">
<i class="fa fa-folder-open-o"></i>
<a href="/category/tech.html">Tech</a>
</li>
<li>
<i class="fa fa-book"></i>
	2.0 min read
      </li>
</ul>
</header>
<div class="content">
<p>Jolla et son SailfishOS sont vraiment de beaux outils mais il faut
avouer qu'ils ont quand même un problème majeur, c'est la piètre qualité
des navigateurs intégrés et surtout du navigateur par défaut.</p>
<p>Malheureusement, l'interface ne propose actuellement aucune option pour
modifier ce comportement. Ainsi, lorsqu'on clique sur un lien dans une
autre application c'est forcement ce navigateur tout moisi qui s'ouvre
et qui met 3 heures à charger la page. Heureusement, avec quelques
bidouille, il est possible de paramétrer Firefox comme navigateur par
défaut, c'est d'ailleurs ce que je viens de faire :)</p>
<p>Si vous avez déjà Firefox d'installé, vous pouvez directement vous
rendre au paragraphe 'Paramétrage d'ADB'.</p>
<div class="section" id="installation-d-aptoide">
<h2>Installation d'Aptoide</h2>
<p>La première étape est d'installer le market Aptoide si ce n'est pas déjà
fait. Pour cela, il faut se rendre dans la Boutique Jolla, puis dans
'Place de marché' tout en bas et installer le market Aptoide Appstore</p>
<p>[gallery size="medium" columns="2" link="file" ids="571,572"]</p>
</div>
<div class="section" id="installation-de-firefox">
<h2>Installation de Firefox</h2>
<p>L'installation de Firefox se fait via Aptoide, il faut donc ouvrir
l'application nouvellement installée et dans la zone de recherche, taper
Firefox. Il faut ensuite trouver l'application <strong>Firefox Browser for
Android</strong> et l'installer.</p>
<p>[gallery link="file" columns="2" size="medium" ids="575,576,577,578"]</p>
</div>
<div class="section" id="parametrage-d-adb">
<h2>Paramétrage d'ADB</h2>
<p>C'est partie pour le bricolage. Il faut d'abord <a class="reference external" href="http://blog.devarieux.net/2015/03/se-connecter-en-ssh-a-son-jolla/">se connecter en
SSH</a>
à l'appareil afin d'y modifier le comportement d'Alien. Pour cela, il
faut éditer le fichier /opt/alien/system/build.prop et ajouter à la fin
:</p>
<pre class="literal-block">
persist.service.adb.enable=1
service.adb.tcp.port=5555
</pre>
<p>Une fois cette modification faite, on relance Alien Dalvik</p>
<pre class="literal-block">
[root@Jolla ~]# systemctl restart aliendalvik.service
</pre>
<p>Maintenant, un process adb doit apparaitre</p>
<pre class="literal-block">
[root@Jolla ~]# ps aux | grep adb
 shell     5162  0.0  0.0   6532    92 ?        Ssl  23:04   0:00 /system/root/sbin/adbd
 root      5592  0.0  0.0   3984   288 pts/0    Sl   23:06   0:00 adb fork-server server
 root      7330  0.0  0.0   2256   544 pts/0    S+   23:57   0:00 grep adb
</pre>
<pre class="literal-block">
[root@Jolla ~]# lsof -p 5162 | grep android_adb
 adbd    5162 shell   10u   CHR      10,25      0t0  1437 /opt/alien/dev/android_adb
</pre>
<p>Une fois que tout ça est ok, on lance en root :</p>
<pre class="literal-block">
[root@localhost bin]# /opt/alien/system/bin/adb kill-server
[root@localhost bin]# /opt/alien/system/bin/adb devices
* daemon not running. starting it now on port 5038 *
* daemon started successfully *
List of devices attached
emulator-5554   device

[root@localhost bin]#
</pre>
</div>
<div class="section" id="parametrage-de-sailfishos">
<h2>Paramétrage de SailfishOS</h2>
<p>La système est maintenant prêt à accueillir nos modifications. Toujours
dans la connexion SSH, se rendre dans /usr/share/applications, faire une
copie de sauvegarde du fichier open-url.desktop et le modifier pour
qu'il ne prenne plus en charge les types MIME http et https</p>
<pre class="literal-block">
cd /usr/share/applications
cp -a open-url.desktop open-url.desktop.ori
vi open-url.desktop
</pre>
<p>Une fois dans le fichier, on supprime la ligne</p>
<pre class="code literal-block">
MimeType=text/html;x-maemo-urischeme/http;x-maemo-urischeme/https;
</pre>
<p>Le fichier doit maintenant ressembler à cela</p>
<pre class="literal-block">
[root@Jolla applications]# cat open-url.desktop
[Desktop Entry]
Type=Application
Name=Browser
NotShowIn=X-MeeGo;
X-MeeGo-Logical-Id=sailfish-browser-ap-name
X-MeeGo-Translation-Catalog=sailfish-browser
X-Maemo-Service=org.sailfishos.browser
X-Maemo-Method=org.sailfishos.browser.openUrl
</pre>
<p>Créer ensuite le fichier firefox-as-default.desktop et y mettre ce
contenu</p>
<pre class="literal-block">
[Desktop Entry]
Type=Application
Name=Browser
NotShowIn=X-MeeGo;
X-MeeGo-Logical-Id=sailfish-browser-ap-name
X-MeeGo-Translation-Catalog=sailfish-browser
X-Maemo-Service=org.sailfishos.browser
X-Maemo-Method=org.sailfishos.browser.openUrl
[root@Jolla applications]# cat firefox-as-default.desktop
[Desktop Entry]
Exec=/opt/alien/system/bin/adb -e shell am start -a android.intent.action.VIEW -n org.mozilla.firefox/.App -d ' %U'
Name=Firefox HTTP handler (opener)
Type=Application
MimeType=text/html;x-maemo-urischeme/http;x-maemo-urischeme/https;
X-Nemo-Application-Type=no-invoker
X-Nemo-Single-Instance=no
X-apkd-apkfile=/data/app/org.mozilla.firefox.apk
NoDisplay=true
</pre>
<p>Afin de prendre ces modifications en compte, on met à jour le cache des
types MIME</p>
<pre class="literal-block">
[root@Jolla applications]# update-desktop-database
</pre>
<p>Le fichier mimeinfo.cache devrait maintenant contenir 2 lignes de ce
type</p>
<pre class="literal-block">
x-maemo-urischeme/http=firefox-as-default.desktop;
x-maemo-urischeme/https=firefox-as-default.desktop;
</pre>
<p>Dorénavant, lorsqu'un lien sera cliqué dans une application (message,
twitter...) celui s'ouvrir avec Firefox.</p>
</div>
</div>
</article>
</div>
</div>
<footer class="footer">
<div class="container">
<div class="row">
<ul class="col-sm-6 list-inline">
<li class="list-inline-item"><a href="/archives.html">Archives</a></li>
<li class="list-inline-item"><a href="/categories.html">Categories</a></li>
<li class="list-inline-item"><a href="/tags.html">Tags</a></li>
</ul>
<p class="col-sm-6 text-sm-right text-muted">
          Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a> / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">✨</a>
</p>
</div>
</div>
</footer>
</body>
</html>